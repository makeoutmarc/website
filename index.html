<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Was kochen wir? üçù</title>

<style>
body {
    font-family: Arial, sans-serif;
    background: #f4f4f4;
    text-align: center;
    padding: 20px;
}
input { padding:10px; width:250px; }
button { padding:10px; margin:5px; cursor:pointer; border:none; border-radius:5px; }
.add-btn { background:green; color:white; }
.random-btn { background:blue; color:white; }
.remove-btn { background:red; color:white; border-radius:50%; width:25px; height:25px; }
.food-item {
    background:white;
    margin:5px auto;
    padding:10px;
    width:300px;
    display:flex;
    justify-content:space-between;
}
#result { font-size:24px; font-weight:bold; margin-top:20px; }
</style>
</head>
<body>

<h1>Was kochen wir? üçù</h1>

<input type="text" id="foodInput" placeholder="Neues Essen hinzuf√ºgen">
<br>
<button class="add-btn" onclick="addFood()">Hinzuf√ºgen</button>

<ul id="foodList"></ul>

<button class="random-btn" onclick="pickRandomFood()">üé≤ Zufallsgericht w√§hlen</button>
<div id="result"></div>

<script type="module">

// Firebase Module importieren
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.9.0/firebase-app.js";
import { 
    getFirestore, 
    collection, 
    addDoc, 
    deleteDoc, 
    doc,
    onSnapshot 
} from "https://www.gstatic.com/firebasejs/12.9.0/firebase-firestore.js";


// üî• Deine Firebase Konfiguration
const firebaseConfig = {
    apiKey: "AIzaSyAZhSBG6zuhlw8nI9hRis8dhj8N0BU-BG4",
    authDomain: "website-essen.firebaseapp.com",
    projectId: "website-essen",
    storageBucket: "website-essen.firebasestorage.app",
    messagingSenderId: "95662683991",
    appId: "1:95662683991:web:0bc5891b804db149647012"
};


// Firebase starten
const app = initializeApp(firebaseConfig);

// Firestore Datenbank starten
const db = getFirestore(app);

// Collection "foods"
const foodsCollection = collection(db, "foods");

// Lokales Array
let foods = [];


// üîÑ Echtzeit Listener (Cloud ‚Üí Website)
onSnapshot(foodsCollection, (snapshot) => {
    foods = [];

    snapshot.forEach((docItem) => {
        foods.push({
            id: docItem.id,
            name: docItem.data().name
        });
    });

    foods.sort((a,b)=> a.name.localeCompare(b.name));
    renderList();
});


// ‚ûï Essen hinzuf√ºgen (Website ‚Üí Cloud)
async function addFood() {
    const input = document.getElementById("foodInput");
    const value = input.value.trim();
    if (value === "") return;

    await addDoc(foodsCollection, {
        name: value
    });

    input.value = "";
}


// ‚ùå Essen l√∂schen (Cloud)
async function removeFood(id) {
    await deleteDoc(doc(db, "foods", id));
}


// üé≤ Zufallsgericht
function pickRandomFood() {
    if (foods.length === 0) return;

    const randomIndex = Math.floor(Math.random() * foods.length);
    document.getElementById("result").innerText = foods[randomIndex].name;
}


// üìã Liste anzeigen
function renderList() {
    const list = document.getElementById("foodList");
    list.innerHTML = "";

    foods.forEach((food) => {
        const li = document.createElement("li");
        li.className = "food-item";

        li.innerHTML = `
            ${food.name}
            <button class="remove-btn" onclick="removeFood('${food.id}')">‚àí</button>
        `;

        list.appendChild(li);
    });
}

</script>

</body>
</html>
